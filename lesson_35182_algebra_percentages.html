<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>אחוזים | אלגברה | שאלון 35182 | פלטפורמת למידה במתמטיקה</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUbKyJZo8" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Assistant', sans-serif; background-color: #f9fafb; }
        .formula-box { background-color: #E5E7EB; padding: 0.75rem; border-radius: 0.375rem; display: inline-block; font-size: 1.125em; line-height: 1.5; margin: 0.25rem 0.1rem; vertical-align: middle; }
        .formula-box-block { background-color: #f3f4f6; padding: 1rem; border-radius: 0.375rem; display: block; font-size: 1.2em; margin: 1rem 0; text-align: center; border: 1px solid #e5e7eb; }
        .formula-box[dir="ltr"] .katex, .formula-box-block[dir="ltr"] .katex { text-align: left !important; }
        #notification-box { transition: opacity 0.5s ease-in-out; }
        .solution { /* For interactive exercise solutions, specific to this lesson's context */
             background-color: #F0FDF4; /* Greenish, from original target */
             border: 1px solid #A7F3D0; /* Greenish border */
             padding: 1rem;
             border-radius: 0.5rem;
             margin-top: 0.5rem;
        }
        .feedback.bg-green-100 { border: 1px solid #a7f3d0; }
        .feedback.bg-red-100 { border: 1px solid #fecaca; }
        .feedback.bg-yellow-100 { border: 1px solid #fde68a; } /* For quiz results */
        .katex-display > .katex { text-align: center; }
        .example-box { /* From original target file */
            border: 1px solid #DBEAFE; 
            background-color: #EFF6FF; 
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }
        /* Table styling from original target file */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .data-table th, .data-table td {
            border: 1px solid #D1D5DB; /* Tailwind gray-300 */
            padding: 0.75rem; /* Tailwind p-3 */
            text-align: right;
        }
        .data-table th {
            background-color: #F3F4F6; /* Tailwind gray-100 */
            font-weight: 600; /* Tailwind font-semibold */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="notification-box" class="fixed top-5 right-5 text-white p-4 rounded-lg shadow-xl hidden z-50 max-w-sm text-right">הודעה תוצג כאן</div>

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        <header class="mb-8">
            <nav aria-label="breadcrumb" class="text-sm text-gray-600 mb-2">
                <ol class="list-none p-0 inline-flex">
                    <li class="flex items-center"><a href="math_platform_main_page_he.html" class="hover:underline">דף ראשי</a> <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></li>
                    <li class="flex items-center"><a href="" id="breadcrumb-questionnaire" class="hover:underline"></a> <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></li>
                    <li class="flex items-center"><span id="breadcrumb-main-topic" class="text-gray-700"></span> <svg class="fill-current w-3 h-3 mx-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"/></svg></li>
                    <li class="flex items-center"><span id="breadcrumb-lesson-name" class="text-gray-500"></span></li>
                </ol>
            </nav>
            <h1 id="lesson-title" class="text-3xl md:text-4xl font-bold text-blue-700"></h1>
        </header>

        <main class="bg-white p-6 md:p-8 rounded-lg shadow-lg">

            <section id="learn" aria-labelledby="learn-heading" class="mb-12">
                <h2 id="learn-heading" class="text-2xl font-semibold text-blue-600 mb-4 border-b-2 border-blue-200 pb-2">לומדים 📚</h2>
                <div class="space-y-6 text-gray-700 leading-relaxed">
                    <p>אחוז הוא דרך לבטא חלק מתוך שלם, כאשר השלם מחולק ל-100 חלקים שווים. המילה "אחוז" משמעותה "מתוך מאה". הסמל של אחוז הוא %.</p>
                    <p>לדוגמה, 25% הם 25 מתוך 100, או <span class="formula-box" dir="ltr">\(\frac{25}{100}\)</span>, ששווה ל-<span class="formula-box" dir="ltr">\(\frac{1}{4}\)</span> או 0.25.</p>
                    
                    <h3 class="text-xl font-semibold mt-6 mb-2">חישוב ערך האחוז מגודל נתון</h3>
                    <p>כדי לחשב <span dir="ltr">\(P\%\)</span> מגודל <span dir="ltr">\(N\)</span>, משתמשים בנוסחה:</p>
                    <div class="my-4 text-center">
                        <span class="formula-box-block" dir="ltr">\(\text{ערך האחוז} = \frac{P}{100} \cdot N\)</span>
                    </div>
                    <p>או בצורה עשרונית: <span class="formula-box" dir="ltr">\(\text{ערך האחוז} = (\text{האחוז כשבר עשרוני}) \cdot N\)</span>.</p>

                    <div class="example-box">
                        <h4 class="text-lg font-semibold mt-4 mb-1">דוגמה:</h4>
                        <p class="font-medium">שאלה: חשב כמה הם 20% מתוך 150.</p>
                        <p class="mt-2"><strong>פתרון:</strong></p>
                        <p>כאן <span class="formula-box" dir="ltr">\(P=20\)</span> ו-<span class="formula-box" dir="ltr">\(N=150\)</span>.</p>
                        <p><span class="formula-box" dir="ltr">\(\text{ערך האחוז} = \frac{20}{100} \cdot 150 = 0.20 \cdot 150 = 30\)</span></p>
                        <p class="mt-2">לכן, 20% מתוך 150 הם 30.</p>
                    </div>

                    <h3 class="text-xl font-semibold mt-6 mb-2">מציאת הגודל השלם (100%)</h3>
                    <p>כאשר נתון חלק מהגודל (ערך האחוז) והאחוז שהוא מהווה, ניתן למצוא את הגודל השלם (<span dir="ltr">\(N\)</span>).</p>
                    <p>אם <span dir="ltr">\(V\)</span> הוא ערך האחוז המהווה <span dir="ltr">\(P\%\)</span> מהשלם <span dir="ltr">\(N\)</span>, אז:</p>
                    <div class="my-4 text-center">
                        <span class="formula-box-block" dir="ltr">\(V = \frac{P}{100} \cdot N \Rightarrow N = \frac{V \cdot 100}{P}\)</span>
                    </div>
                    
                    <div class="example-box">
                        <h4 class="text-lg font-semibold mt-4 mb-1">דוגמה:</h4>
                        <p class="font-medium">שאלה: 40 ש"ח הם 10% ממחיר מסוים. מהו המחיר המלא?</p>
                        <p class="mt-2"><strong>פתרון:</strong></p>
                        <p>כאן <span class="formula-box" dir="ltr">\(V=40\)</span> ו-<span class="formula-box" dir="ltr">\(P=10\)</span>.</p>
                        <p><span class="formula-box" dir="ltr">\(N = \frac{40 \cdot 100}{10} = \frac{4000}{10} = 400\)</span></p>
                        <p class="mt-2">המחיר המלא הוא 400 ש"ח.</p>
                    </div>

                    <h3 class="text-xl font-semibold mt-6 mb-2">בעיות התייקרות והוזלה</h3>
                    <p>אחוזים משמשים לעיתים קרובות לתיאור שינויים במחירים או בכמויות.</p>
                    
                    <h4 class="text-lg font-semibold mt-4 mb-1">שימוש בטבלה לארגון נתונים בבעיות אחוזים</h4>
                    <p>כאשר פותרים בעיות מילוליות עם אחוזים, במיוחד כאלה הכוללות התייקרות או הוזלה, טבלה יכולה לעזור מאוד לארגן את הנתונים ולהבין את הקשרים ביניהם לפני בניית המשוואה. הטבלה בדרך כלל תכלול עמודות עבור:</p>
                    <ul class="list-disc list-inside space-y-1 pr-5">
                        <li><strong>תיאור / פריט</strong></li>
                        <li><strong>ערך התחלתי / מקורי (100%)</strong></li>
                        <li><strong>אחוז השינוי (+% להתייקרות, -% להוזלה)</strong></li>
                        <li><strong>סכום השינוי (הערך של האחוז)</strong></li>
                        <li><strong>ערך סופי / חדש</strong></li>
                    </ul>
                    <p>לא תמיד צריך למלא את כל העמודות, אך הן עוזרות לחשוב על כל המרכיבים.</p>

                    <div class="example-box">
                        <h4 class="text-lg font-semibold mt-4 mb-1">דוגמה פתורה (מתוך חומר הבחינה) עם שימוש בטבלה:</h4>
                        <p class="font-medium">שאלה: מחיר מוצר הוא 200 ש"ח. המוצר התייקר ב-15%. מהו מחירו החדש?</p>
                        <p class="mt-2"><strong>ארגון הנתונים בטבלה:</strong></p>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>תיאור</th>
                                    <th>מחיר מקורי (ש"ח)</th>
                                    <th>אחוז השינוי</th>
                                    <th>סכום השינוי (ש"ח)</th>
                                    <th>מחיר חדש (ש"ח)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>מחיר המוצר</td>
                                    <td>200 (זה ה-100%)</td>
                                    <td>+15% (התייקרות)</td>
                                    <td>?</td>
                                    <td>?</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-2"><strong>פתרון:</strong></p>
                        <p>אנו יודעים שהמחיר המקורי הוא 200 ש"ח.</p>
                        <p>1. <strong>חישוב סכום השינוי:</strong> ההתייקרות היא 15% מהמחיר המקורי.</p>
                        <p><span class="formula-box" dir="ltr">\(\text{סכום השינוי} = \frac{15}{100} \cdot 200 = 0.15 \cdot 200 = 30\)</span> ש"ח.</p>
                        <p>נמלא בטבלה:</p>
                         <table class="data-table">
                            <tbody>
                                <tr>
                                    <td>מחיר המוצר</td>
                                    <td>200</td>
                                    <td>+15%</td>
                                    <td><strong>30</strong></td>
                                    <td>?</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-2">2. <strong>חישוב המחיר החדש:</strong></p>
                        <p>המחיר החדש = מחיר מקורי + סכום השינוי (ההתייקרות).</p>
                        <p><span class="formula-box" dir="ltr">\(\text{מחיר חדש} = 200 + 30 = 230\)</span> ש"ח.</p>
                         <p>נשלים את הטבלה:</p>
                         <table class="data-table">
                            <tbody>
                                <tr>
                                    <td>מחיר המוצר</td>
                                    <td>200</td>
                                    <td>+15%</td>
                                    <td>30</td>
                                    <td><strong>230</strong></td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-2">מחירו החדש של המוצר הוא 230 ש"ח.</p>
                        
                        <p class="mt-4"><strong>דרך נוספת (ישירה למחיר החדש):</strong></p>
                        <p>אם המחיר התייקר ב-15%, אז המחיר החדש מהווה <span class="formula-box" dir="ltr">\(100\% + 15\% = 115\%\)</span> מהמחיר המקורי.</p>
                        <p>המחיר החדש <span class="formula-box" dir="ltr">\(M_1\)</span> הוא:</p>
                        <p><span class="formula-box" dir="ltr">\(M_1 = \frac{115}{100} \cdot 200 = 1.15 \cdot 200 = 230\)</span> ש"ח.</p>
                        <p>או באמצעות הנוסחה הכללית להתייקרות: <span class="formula-box" dir="ltr">\(M_1 = M_0 \left(1 + \frac{P}{100}\right)\)</span></p>
                        <p><span class="formula-box" dir="ltr">\(M_1 = 200 \left(1 + \frac{15}{100}\right) = 200 \cdot (1 + 0.15) = 200 \cdot 1.15 = 230\)</span> ש"ח.</p>
                    </div>
                    
                    <div class="example-box">
                        <h4 class="text-lg font-semibold mt-4 mb-1">דוגמה נוספת עם הוזלה:</h4>
                        <p class="font-medium">שאלה: מחיר מכנסיים היה 300 ש"ח. הם הוזלו ב-20%. מה מחירם החדש?</p>
                        <p class="mt-2"><strong>ארגון בטבלה:</strong></p>
                         <table class="data-table">
                            <thead>
                                <tr>
                                    <th>תיאור</th>
                                    <th>מחיר מקורי (ש"ח)</th>
                                    <th>אחוז השינוי</th>
                                    <th>סכום השינוי (ש"ח)</th>
                                    <th>מחיר חדש (ש"ח)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>מחיר מכנסיים</td>
                                    <td>300</td>
                                    <td>-20% (הוזלה)</td>
                                    <td>?</td>
                                    <td>?</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-2"><strong>פתרון:</strong></p>
                        <p>1. <strong>סכום השינוי (ההוזלה):</strong> <span class="formula-box" dir="ltr">\(\frac{20}{100} \cdot 300 = 0.20 \cdot 300 = 60\)</span> ש"ח.</p>
                        <p>2. <strong>המחיר החדש:</strong> <span class="formula-box" dir="ltr">\(300 - 60 = 240\)</span> ש"ח.</p>
                        <p class="mt-2">המחיר החדש הוא 240 ש"ח.</p>
                        <p class="mt-2"><strong>דרך ישירה:</strong> אם הוזל ב-20%, המחיר החדש הוא <span class="formula-box" dir="ltr">\(100\% - 20\% = 80\%\)</span> מהמקורי.</p>
                        <p><span class="formula-box" dir="ltr">\(M_1 = \frac{80}{100} \cdot 300 = 0.80 \cdot 300 = 240\)</span> ש"ח.</p>
                    </div>

                </div>
            </section>

            <section id="practice" aria-labelledby="practice-heading" class="mb-12">
                <h2 id="practice-heading" class="text-2xl font-semibold text-blue-600 mb-4 border-b-2 border-blue-200 pb-2">מתרגלים ✍️</h2>
                <div class="space-y-8 mt-6"> 
                    <div class="exercise p-4 border border-gray-300 rounded-lg bg-gray-50">
                        <p class="exercise-question font-medium">תרגיל 1: כמה הם 30% מתוך 250?</p>
                        <div class="mt-3">
                            <input type="text" id="ex1-answer" class="border border-gray-300 p-2 rounded w-full md:w-1/2 focus:ring-blue-500 focus:border-blue-500" placeholder="הכנס תשובה מספרית">
                        </div>
                        <div class="mt-3">
                            <button onclick="checkAnswer('ex1', '75')" class="check-answer-btn bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out">בדוק תשובה</button>
                            <button onclick="showSolution('sol1')" class="show-solution-btn bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out ml-2">הצג פתרון</button>
                        </div>
                        <div id="feedback-ex1" class="feedback hidden mt-3 p-3 rounded-md text-sm"></div>
                        <div id="sol1" class="solution hidden">
                            <p><strong>פתרון מלא:</strong></p>
                            <p><span class="formula-box" dir="ltr">\(\frac{30}{100} \cdot 250 = 0.30 \cdot 250 = 75\)</span></p>
                            <p>התשובה היא 75.</p>
                        </div>
                    </div>

                    <div class="exercise p-4 border border-gray-300 rounded-lg bg-gray-50">
                        <p class="exercise-question font-medium">תרגיל 2: מחיר חולצה היה 120 ש"ח. החולצה הוזלה ב-25%. מה מחירה החדש?</p>
                        <p class="text-sm text-gray-600 mt-1">נסה להשתמש בטבלה לארגון הנתונים לפני החישוב.</p>
                        <div class="mt-3">
                            <input type="text" id="ex2-answer" class="border border-gray-300 p-2 rounded w-full md:w-1/2 focus:ring-blue-500 focus:border-blue-500" placeholder="הכנס מחיר חדש">
                        </div>
                        <div class="mt-3">
                            <button onclick="checkAnswer('ex2', '90')" class="check-answer-btn bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out">בדוק תשובה</button>
                            <button onclick="showSolution('sol2')" class="show-solution-btn bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-md transition duration-150 ease-in-out ml-2">הצג פתרון</button>
                        </div>
                        <div id="feedback-ex2" class="feedback hidden mt-3 p-3 rounded-md text-sm"></div>
                        <div id="sol2" class="solution hidden">
                            <p><strong>פתרון מלא:</strong></p>
                            <p>טבלת עזר:</p>
                            <table class="data-table text-sm">
                                <thead><tr><th>תיאור</th><th>מחיר מקורי</th><th>אחוז שינוי</th><th>סכום שינוי</th><th>מחיר חדש</th></tr></thead>
                                <tbody><tr><td>חולצה</td><td>120</td><td>-25%</td><td>30</td><td>90</td></tr></tbody>
                            </table>
                            <p>גודל ההוזלה: <span class="formula-box" dir="ltr">\(\frac{25}{100} \cdot 120 = 0.25 \cdot 120 = 30\)</span> ש"ח.</p>
                            <p>המחיר החדש: <span class="formula-box" dir="ltr">\(120 - 30 = 90\)</span> ש"ח.</p>
                            <p>לחלופין: <span class="formula-box" dir="ltr">\(120 \left(1 - \frac{25}{100}\right) = 120 \cdot 0.75 = 90\)</span> ש"ח.</p>
                            <p>המחיר החדש הוא 90 ש"ח.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="test-yourself" aria-labelledby="test-heading" class="mb-12">
                <h2 id="test-heading" class="text-2xl font-semibold text-blue-600 mb-4 border-b-2 border-blue-200 pb-2">בחן את עצמך 🧐</h2>
                <div class="space-y-6">
                    <div class="quiz-question p-4 border border-gray-300 rounded-lg bg-gray-50">
                        <p class="font-medium">שאלה 1: בכיתה 30 תלמידים. 60% מהם בנות. כמה בנים בכיתה?</p>
                        <div class="mt-2 space-y-1">
                            <label class="flex items-center"><input type="radio" name="q1" value="a" class="ml-2"> 12</label>
                            <label class="flex items-center"><input type="radio" name="q1" value="b" class="ml-2"> 18</label>
                            <label class="flex items-center"><input type="radio" name="q1" value="c" class="ml-2"> 10</label>
                            <label class="flex items-center"><input type="radio" name="q1" value="d" class="ml-2"> 15</label>
                        </div>
                    </div>
                    <div class="quiz-question p-4 border border-gray-300 rounded-lg bg-gray-50">
                        <p class="font-medium">שאלה 2: מחיר ספר התייקר מ-80 ש"ח ל-100 ש"ח. בכמה אחוזים התייקר הספר?</p>
                        <div class="mt-2 space-y-1">
                            <label class="flex items-center"><input type="radio" name="q2" value="a" class="ml-2"> 20%</label>
                            <label class="flex items-center"><input type="radio" name="q2" value="b" class="ml-2"> 25%</label>
                            <label class="flex items-center"><input type="radio" name="q2" value="c" class="ml-2"> 15%</label>
                            <label class="flex items-center"><input type="radio" name="q2" value="d" class="ml-2"> 30%</label>
                        </div>
                    </div>
                    <button id="submit-quiz" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md transition duration-150 ease-in-out">הגש בוחן</button>
                    <div id="quiz-results" class="hidden mt-3 p-3 rounded-md text-sm"></div>
                </div>
            </section>

            <section id="progressSection" class="text-center p-6 bg-white rounded-lg shadow-md mt-10">
                <button id="markCompletedBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg text-lg transition duration-150 ease-in-out shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                    סמן שיעור כהושלם ✅
                </button>
                <p id="completionStatus" class="mt-3 text-sm text-gray-600 min-h-[20px]"></p>
                <div id="postCompletionButtons" class="mt-4 space-x-0 md:space-x-4 space-y-3 md:space-y-0 rtl:space-x-reverse hidden">
                    <button id="nextLessonBtn" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-md transition">השיעור הבא &rarr;</button>
                    <button id="returnToMenuBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-md transition">חזור לרשימת השיעורים</button>
                </div>
            </section>
        </main>

        <footer class="text-center text-gray-600 mt-12 py-4 border-t border-gray-300 no-print">
            <p>&copy; <span id="current-year"></span> פלטפורמת למידה במתמטיקה. כל הזכויות שמורות.</p>
        </footer>
    </div>

    <script>
        const LESSON_ID = '35182_algebra_percentages';
        const LESSON_TITLE_FOR_NOTIFICATION = 'אחוזים';
        const QUESTIONNAIRE_PAGE_URL = 'questionnaire_35182_lessons_page_he.html';
        const NEXT_LESSON_URL = 'lesson_35182_algebra_word_problems.html'; 

        function showNotification(message, type = 'info', duration = 3000) { 
            const notificationBox = document.getElementById('notification-box');
            if (!notificationBox) return;
            notificationBox.textContent = message;
            notificationBox.className = 'fixed top-5 right-5 text-white p-4 rounded-lg shadow-xl z-50 max-w-sm text-right'; 
            if (type === 'success') notificationBox.classList.add('bg-green-500');
            else if (type === 'error') notificationBox.classList.add('bg-red-500');
            else notificationBox.classList.add('bg-blue-500'); // Kept from original target
            notificationBox.classList.remove('hidden');
            notificationBox.style.opacity = 1;
            setTimeout(() => {
                notificationBox.style.opacity = 0;
                setTimeout(() => { notificationBox.classList.add('hidden'); }, 500); 
            }, duration);
        }

        function markLessonAsCompleted() { // From reference
            const lessonId = LESSON_ID;
            try {
                localStorage.setItem(`lesson_completed_${lessonId}`, 'true');
                const statusEl = document.getElementById('completionStatus');
                const buttonEl = document.getElementById('markCompletedBtn');
                const postCompletionButtonsDiv = document.getElementById('postCompletionButtons');
                const nextLessonBtn = document.getElementById('nextLessonBtn');
                const returnToMenuBtn = document.getElementById('returnToMenuBtn');

                if (statusEl) {
                    statusEl.textContent = 'השיעור סומן כהושלם!';
                    statusEl.className = 'mt-3 text-sm text-green-600 font-semibold';
                }
                if (buttonEl) {
                    buttonEl.disabled = true;
                    buttonEl.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                    buttonEl.classList.add('bg-gray-400', 'cursor-not-allowed', 'opacity-75');
                    buttonEl.innerHTML = 'השיעור הושלם 👍';
                }
                if (postCompletionButtonsDiv) postCompletionButtonsDiv.classList.remove('hidden');
                if (nextLessonBtn) {
                    if (NEXT_LESSON_URL) nextLessonBtn.onclick = () => { window.location.href = NEXT_LESSON_URL; };
                    else {
                        nextLessonBtn.textContent = 'כל הכבוד! סיימת את החלק הזה.';
                        nextLessonBtn.disabled = true;
                        nextLessonBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
                        nextLessonBtn.classList.remove('bg-green-500', 'hover:bg-green-600');
                    }
                }
                if (returnToMenuBtn) returnToMenuBtn.onclick = () => { window.location.href = QUESTIONNAIRE_PAGE_URL; };
                showNotification('השיעור ' + LESSON_TITLE_FOR_NOTIFICATION + ' סומן כהושלם!', 'success');
            } catch (e) {
                const statusEl = document.getElementById('completionStatus');
                if (statusEl) {
                    statusEl.textContent = 'שגיאה בשמירת ההתקדמות. ודא ש-localStorage מאופשר.';
                    statusEl.className = 'mt-3 text-sm text-red-600 font-semibold';
                }
                showNotification('שגיאה בשמירת ההתקדמות.', 'error');
            }
        }

        function checkLessonStatus() { // From reference
            const lessonId = LESSON_ID;
            try {
                const isCompleted = localStorage.getItem(`lesson_completed_${lessonId}`);
                const statusEl = document.getElementById('completionStatus');
                const buttonEl = document.getElementById('markCompletedBtn');
                const postCompletionButtonsDiv = document.getElementById('postCompletionButtons');
                const nextLessonBtn = document.getElementById('nextLessonBtn');
                const returnToMenuBtn = document.getElementById('returnToMenuBtn');

                if (isCompleted === 'true') {
                    if (statusEl) {
                        statusEl.textContent = 'שיעור זה הושלם בעבר.';
                        statusEl.className = 'mt-3 text-sm text-green-600 font-semibold';
                    }
                    if (buttonEl) {
                        buttonEl.disabled = true;
                        buttonEl.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
                        buttonEl.classList.add('bg-gray-400', 'cursor-not-allowed', 'opacity-75');
                        buttonEl.innerHTML = 'השיעור הושלם 👍';
                    }
                    if (postCompletionButtonsDiv) postCompletionButtonsDiv.classList.remove('hidden');
                    if (nextLessonBtn) {
                        if (NEXT_LESSON_URL) nextLessonBtn.onclick = () => { window.location.href = NEXT_LESSON_URL; };
                        else {
                            nextLessonBtn.textContent = 'כל הכבוד! סיימת את החלק הזה.';
                            nextLessonBtn.disabled = true;
                            nextLessonBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
                            nextLessonBtn.classList.remove('bg-green-500', 'hover:bg-green-600');
                        }
                    }
                    if (returnToMenuBtn) returnToMenuBtn.onclick = () => { window.location.href = QUESTIONNAIRE_PAGE_URL; };
                } else {
                    if (postCompletionButtonsDiv) postCompletionButtonsDiv.classList.add('hidden');
                }
            } catch (e) {
                const statusEl = document.getElementById('completionStatus');
                if (statusEl) {
                    statusEl.textContent = 'שגיאה בטעינת סטטוס השיעור.';
                    statusEl.className = 'mt-3 text-sm text-red-600 font-semibold';
                }
                const postCompletionButtonsDiv = document.getElementById('postCompletionButtons');
                if (postCompletionButtonsDiv) postCompletionButtonsDiv.classList.add('hidden');
            }
        }
        
        function checkAnswer(exerciseId, correctAnswer) { // Specific to this lesson
            const feedbackEl = document.getElementById(`feedback-${exerciseId}`);
            const userAnswer = document.getElementById(`${exerciseId}-answer`).value.trim();
            if (userAnswer === correctAnswer) {
                feedbackEl.textContent = 'נכון מאוד! כל הכבוד! 👍';
                feedbackEl.className = 'feedback mt-3 p-3 rounded-md text-sm bg-green-100 text-green-700 border border-green-300';
            } else {
                feedbackEl.textContent = 'תשובה שגויה. נסה שוב או הצג את הפתרון. 🤔';
                feedbackEl.className = 'feedback mt-3 p-3 rounded-md text-sm bg-red-100 text-red-700 border border-red-300';
            }
            feedbackEl.classList.remove('hidden');
        }

        function showSolution(solutionId) { // Specific to this lesson
            const solutionEl = document.getElementById(solutionId);
            if (solutionEl) {
                solutionEl.classList.toggle('hidden');
                if (!solutionEl.classList.contains('hidden')) renderMathInElement(solutionEl);
            }
        }

        const quizSubmitButton = document.getElementById('submit-quiz'); // Specific to this lesson
        if (quizSubmitButton) {
            quizSubmitButton.addEventListener('click', function() {
                let score = 0;
                const totalQuestions = 2;
                const correctAnswers = { q1: 'a', q2: 'b' }; 
                const q1Answer = document.querySelector('input[name="q1"]:checked');
                if (q1Answer && q1Answer.value === correctAnswers.q1) score++;
                const q2Answer = document.querySelector('input[name="q2"]:checked');
                if (q2Answer && q2Answer.value === correctAnswers.q2) score++;
                const resultsEl = document.getElementById('quiz-results');
                resultsEl.innerHTML = `הציון שלך הוא: <strong>${score}</strong> מתוך ${totalQuestions}.`;
                resultsEl.className = 'mt-3 p-3 rounded-md text-sm bg-yellow-100 text-yellow-700 border border-yellow-300';
                resultsEl.classList.remove('hidden');
                recordQuizScore(LESSON_ID, score, totalQuestions);
                showNotification(`הבוחן הוגש! ציון: ${score}/${totalQuestions}`, 'info');
            });
        }

        function recordQuizScore(lessonId, score, totalQuestions) { // Specific to this lesson
            try {
                localStorage.setItem(`lesson_quiz_score_${lessonId}`, JSON.stringify({score, totalQuestions, date: new Date().toISOString()}));
            } catch (e) {
                showNotification("שגיאה בשמירת ציון הבוחן.", "error");
            }
        }
        
        function renderMathInElement(element) { // From reference
            if (window.renderMathInElement && element) {
                window.renderMathInElement(element, {
                    delimiters: [ {left: "\(", right: "\)", display: false}, {left: "\[", right: "\]", display: true} ],
                    throwOnError: false
                });
            }
        }

        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body);
            document.getElementById('current-year').textContent = new Date().getFullYear();
            const markCompletedBtn = document.getElementById('markCompletedBtn');
            if (markCompletedBtn) markCompletedBtn.addEventListener('click', markLessonAsCompleted);
            checkLessonStatus();

            document.title = LESSON_TITLE_FOR_NOTIFICATION + " | אלגברה | שאלון 35182 | פלטפורמת למידה במתמטיקה";
            const lessonTitleElement = document.getElementById('lesson-title');
            if(lessonTitleElement) lessonTitleElement.innerHTML = LESSON_TITLE_FOR_NOTIFICATION + " <span class='text-2xl md:text-3xl'>%</span>"; 
            const breadcrumbQ = document.getElementById('breadcrumb-questionnaire');
            if(breadcrumbQ) {
                breadcrumbQ.textContent = 'שאלון 35182'; 
                breadcrumbQ.href = QUESTIONNAIRE_PAGE_URL;
            }
            const breadcrumbMainTopic = document.getElementById('breadcrumb-main-topic');
            if(breadcrumbMainTopic) breadcrumbMainTopic.textContent = 'אלגברה'; 
            const breadcrumbLessonName = document.getElementById('breadcrumb-lesson-name');
            if(breadcrumbLessonName) breadcrumbLessonName.textContent = LESSON_TITLE_FOR_NOTIFICATION;
        });
    </script>
</body>
</html>
